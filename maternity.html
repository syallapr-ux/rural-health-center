<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Maternity & Maternal Health | Rural Health Connect</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet">

<style>
    .error { border: 2px solid #dc3545; }
    .high-risk-row { background-color: #fff3cd; }
    .referred-row { background-color: #f8d7da; }
    .success-msg { color: #28a745; }
    .alert { padding: 10px; }
</style>
</head>

<body class="bg-light">

<nav class="navbar navbar-dark bg-primary shadow">
<div class="container">
<span class="navbar-brand fw-bold">
<i class="fa-solid fa-person-pregnant me-2"></i>
Maternal & Child Health Portal
</span>
</div>
</nav>

<header class="bg-dark text-white py-4">
<div class="container">
<h3 class="fw-bold">Maternity & Maternal Health Services</h3>
<p class="mb-0">ANC | High-Risk Monitoring | Institutional Deliveries</p>
</div>
</header>

<main class="container my-5">

<!-- DASHBOARD -->
<section class="mb-5">
<h4 class="fw-bold mb-3">Facility Dashboard</h4>
<div class="row g-3 text-center">
<div class="col-md-3"><div class="card p-3"><h6>Active Pregnancies</h6><h4 id="activeCount">0</h4></div></div>
<div class="col-md-3"><div class="card p-3"><h6>High-Risk Cases</h6><h4 class="text-danger" id="riskCount">0</h4></div></div>
<div class="col-md-3"><div class="card p-3"><h6>Institutional Deliveries</h6><h4 id="deliveryCount">0</h4></div></div>
<div class="col-md-3"><div class="card p-3"><h6>JSY Beneficiaries</h6><h4 id="jsyCount">0</h4></div></div>
</div>
</section>

<!-- ANC FORM -->
<section class="mb-5">
<div class="card shadow">
<div class="card-body">
<h4 class="fw-bold mb-3">ANC Registration</h4>

<div class="row g-3">
<input class="form-control" placeholder="Mother Name" id="mother">
<input class="form-control" placeholder="ABHA / Aadhaar" id="abha">
<input class="form-control" type="number" placeholder="Gestational Age (weeks)" id="weeks">
<select class="form-select" id="risk">
<option value="">Risk Category</option>
<option>Normal</option>
<option>Moderate Risk</option>
<option>High Risk</option>
</select>
</div>

<button class="btn btn-primary mt-3" onclick="registerANC()">Register ANC</button>

<div class="alert alert-info mt-3 small">
Data stored locally (simulating RCH / HMIS backend).
</div>
</div>
</div>
</section>

<!-- HIGH RISK TABLE -->
<section>
<h4 class="fw-bold mb-3 text-danger">High-Risk Pregnancy Monitoring</h4>
<table class="table table-bordered bg-white">
<thead class="table-light">
<tr>
<th>ANC ID</th><th>Name</th><th>Risk</th><th>Status</th>
</tr>
</thead>
<tbody id="riskTable"></tbody>
</table>
</section>

</main>

<footer class="bg-dark text-light text-center py-3 small">
Maternal Health Module â€“ Simulation of NHM Systems
</footer>

<script>
// Retrieve data from localStorage, or initialize as empty array if no data exists
let data = JSON.parse(localStorage.getItem("ancData")) || [];

// Update Dashboard with counts
function updateDashboard() {
    document.getElementById("activeCount").innerText = data.length;
    document.getElementById("riskCount").innerText = data.filter(d => d.risk==="High Risk").length;
    document.getElementById("deliveryCount").innerText = Math.floor(data.length * 0.4);
    document.getElementById("jsyCount").innerText = Math.floor(data.length * 0.3);
}

// Render High-Risk Table
function renderTable() {
    const table = document.getElementById("riskTable");
    table.innerHTML = "";
    data.filter(d => d.risk === "High Risk").forEach(d => {
        table.innerHTML += `
        <tr class="${d.status === 'Referred' ? 'referred-row' : 'high-risk-row'}">
            <td>${d.id}</td>
            <td>${d.name}</td>
            <td>${d.risk}</td>
            <td>${d.status}</td>
        </tr>`;
    });
}

// Register ANC Case
function registerANC() {
    let m = document.getElementById("mother").value,
        a = document.getElementById("abha").value,
        w = document.getElementById("weeks").value,
        r = document.getElementById("risk").value;

    // Clear any previous error highlights
    document.querySelectorAll(".form-control, .form-select").forEach(f => f.classList.remove("error"));

    // Validate input fields
    if (!m || !a || !w || !r || a.length < 10) {
        document.querySelectorAll(".form-control, .form-select").forEach(f => !f.value && f.classList.add("error"));
        alert("Please fill all fields correctly");
        return;
    }

    // Generate ANC ID and add to data
    data.push({
        id: "ANC-" + (1000 + data.length),
        name: m,
        risk: r,
        status: r === "High Risk" ? "Under Monitoring" : "Normal"
    });

    // Store the updated data in localStorage
    localStorage.setItem("ancData", JSON.stringify(data));

    // Update Dashboard and High-Risk Table
    updateDashboard();
    renderTable();

    // Display success message
    alert("ANC Registered Successfully");

    // Reset the form fields
    document.querySelectorAll("input,select").forEach(i => i.value = "");
}

// Initial data loading
updateDashboard();
renderTable();

</script>

</body>
</html>
